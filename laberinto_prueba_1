#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <ncurses.h>

#define SIZE 10

void create_maze(char maze[SIZE][SIZE]) {
    for (int i = 0; i < SIZE; i++) {
        for (int j = 0; j < SIZE; j++) {
            if (rand() % 100 < 30) {
                maze[i][j] = '*';
            } else {
                maze[i][j] = ' ';
            }
        }
    }
    maze[0][0] = ' ';
    maze[SIZE-1][SIZE-1] = ' ';
}

void print_maze(WINDOW *win, char maze[SIZE][SIZE], int player_x, int player_y) {
    wclear(win);
    for (int i = 0; i < SIZE; i++) {
        for (int j = 0; j < SIZE; j++) {
            if (i == player_x && j == player_y) {
                wattron(win, A_REVERSE);
                mvwprintw(win, i + 1, j * 2 + 1, "O");
                wattroff(win, A_REVERSE);
            } else {
                mvwprintw(win, i + 1, j * 2 + 1, "%c", maze[i][j]);
            }
        }
    }
    box(win, 0, 0);
    wrefresh(win);
}

void move_player(int *player_x, int *player_y, int ch, char maze[SIZE][SIZE]) {
    int x = *player_x;
    int y = *player_y;

    switch (ch) {
        case KEY_UP:
            if (x > 0 && maze[x-1][y] != '*') x--;
            break;
        case KEY_DOWN:
            if (x < SIZE-1 && maze[x+1][y] != '*') x++;
            break;
        case KEY_LEFT:
            if (y > 0 && maze[x][y-1] != '*') y--;
            break;
        case KEY_RIGHT:
            if (y < SIZE-1 && maze[x][y+1] != '*') y++;
            break;
    }

    *player_x = x;
    *player_y = y;
}

int main() {
    char maze[SIZE][SIZE];
    int player_x = 0, player_y = 0;
    int ch;

    srand(time(0));
    create_maze(maze);

    initscr();
    noecho();
    cbreak();
    keypad(stdscr, TRUE);

    WINDOW *win = newwin(SIZE + 2, SIZE * 2 + 2, 1, 1);

    while (player_x != SIZE-1 || player_y != SIZE-1) {
        print_maze(win, maze, player_x, player_y);
        ch = getch();
        move_player(&player_x, &player_y, ch, maze);
    }

    print_maze(win, maze, player_x, player_y);
    mvwprintw(win, SIZE/2 + 1, (SIZE * 2 - 10) / 2, "Â¡Ganaste!");
    wrefresh(win);
    getch();

    endwin();
    return 0;
}
